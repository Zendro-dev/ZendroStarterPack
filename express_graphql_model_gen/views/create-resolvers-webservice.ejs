const <%-nameLc-%> =  require('../models-webservice/<%-nameLc-%>');
const searchArg = require('../utils/search-argument');
const resolvers = require('./index');

<% associations_temp = associations.explicit_resolvers["belongsTo"]-%>
<% for(let i=0; i < associations_temp.length; i++){ -%>
  <%- nameLc -%>.prototype.<%=associations_temp[i].target.toLowerCase()%> = function(_, context){
    return resolvers.readOne<%=associations_temp[i].target_cp%>({"id" : this.<%=associations_temp[i].targetKey%>},context);
  }
<%}-%>

<% associations_temp = associations.explicit_resolvers["hasOne"]-%>
<% for(let i=0; i < associations_temp.length; i++){ -%>
  <%- nameLc -%>.prototype.<%=associations_temp[i].target.toLowerCase()%> = function(_, context){
    return resolvers.<%=associations_temp[i].target_pl.toLowerCase()%>({"search":{"field" : "<%=associations_temp[i].targetKey%>", "value":{"value":this.id }, "operator": "eq"}},context);
  }
<%}-%>

<% associations_temp = associations.explicit_resolvers["hasMany"]-%>
<% for(let i=0; i < associations_temp.length; i++){ -%>
  <%- nameLc -%>.prototype.<%=associations_temp[i].target_pl.toLowerCase()%>Filter = function({search,order, pagination}, context){
    if(search === undefined)
    {
      return resolvers.<%=associations_temp[i].target_pl.toLowerCase()%>({"search":{"field" : "<%=associations_temp[i].targetKey%>", "value":{"value":this.id }, "operator": "eq"}, order, pagination},context);
    }else{
      return resolvers.<%=associations_temp[i].target_pl.toLowerCase()%>({"search":{"operator":"and", "search":[ {"field" : "<%=associations_temp[i].targetKey%>", "value":{"value":this.id }, "operator": "eq"} , search] }, order, pagination },context)
    }

  }

  <%- nameLc -%>.prototype.countFiltered<%=associations_temp[i].target_cp_pl%> = function({search}, context){

    if(search === undefined)
    {
      return resolvers.count<%=associations_temp[i].target_cp_pl%>({"search":{"field" : "<%=associations_temp[i].targetKey%>", "value":{"value":this.id }, "operator": "eq"} }, context);
    }else{
      return resolvers.count<%=associations_temp[i].target_cp_pl%>({"search":{"operator":"and", "search":[ {"field" : "<%=associations_temp[i].targetKey%>", "value":{"value":this.id }, "operator": "eq"} , search] }},context)
    }

  }
<%}-%>



module.exports = {
  <%- namePl -%>: function({search,order,pagination}, context){
    /*
    YOUR CODE GOES HERE
    */
  },

  readOne<%- name -%>: function({id}, context){
    /*
    YOUR CODE GOES HERE
    */
  },

  count<%- namePlCp -%>: function({search},context){
    /*
    YOUR CODE GOES HERE
    */
  }
}
